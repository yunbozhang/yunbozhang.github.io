<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <title>玻璃</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="玻璃">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="玻璃">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="玻璃">
<meta name="twitter:description">
  
    <link rel="alternative" href="/atom.xml" title="玻璃" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>

<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="null" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">ICQ</a></h1>
		</hgroup>

		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>標籤</li>
						
						
						<li>關於</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="/#" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="/#" title="weibo">weibo</a>
					        
								<a class="rss" target="_blank" href="/#" title="rss">rss</a>
					        
								<a class="zhihu" target="_blank" href="/#" title="zhihu">zhihu</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						
					</div>
				</section>
				
				
				

				
				
				<section class="switch-part switch-part3">
				
					<div id="js-aboutme">我是谁，我从哪里来，我到哪里去？我就是我，是颜色不一样的吃货…</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">ICQ</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
			
				<img lazy-src="null" class="js-avatar">
			
			</div>
			<hgroup>
			  <h1 class="header-author">ICQ</h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="/#" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="/#" title="weibo">weibo</a>
			        
						<a class="rss" target="_blank" href="/#" title="rss">rss</a>
			        
						<a class="zhihu" target="_blank" href="/#" title="zhihu">zhihu</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>

      <div class="body-wrap">
  
    <article id="post-hh" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/04/08/hh/" class="article-date">
  	<time datetime="2016-04-08T07:31:09.000Z" itemprop="datePublished">2016-04-08</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/08/hh/">hh</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        
      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-XMPP" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/30/XMPP/" class="article-date">
  	<time datetime="2016-03-30T08:49:45.000Z" itemprop="datePublished">2016-03-30</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="iOS_XMPP">iOS XMPP</h1><h2 id="一、XMPP简介">一、XMPP简介</h2><ul>
<li>XMPP-可扩展信息与存在协议，是目前主流的四种IM协议之一，其他三种分别为：即时信息和空间协议（IMPP）、空间和即时信息协议（PRIM）、针对即时通讯和空间平衡扩充的进程开始协议SIP（SIMPLE）</li>
</ul>
<h3 id="XMPP系统的特点">XMPP系统的特点</h3><ul>
<li>客户机/服务器通信模式</li>
<li>分布式网络</li>
<li>简单的客户端</li>
<li>XML的数据格式</li>
</ul>
<h2 id="二、XMPP工作原理">二、XMPP工作原理</h2><p>协议网络架构<br>XMPP中定义了三个角色：客户端，服务器，网关。</p>
<ul>
<li>服务器同时承担了客户端信息记录，连接管理和信息的路由功能。</li>
<li>网关承担着与异构即时通信系统的互联互通，异构系统可以包括SMS（短信），MSN，ICQ等。</li>
<li>基本的网络形式是单客户端通过TCP/IP连接到单服务器，然后在之上传输XML。</li>
</ul>
<p>XMPP是一个典型的C/S架构，而不是像大多数即时通讯软件一样，使用P2P客户端到客户端的架构，也就是说在大多数情况下，当两个客户端进行通讯时，他们的消息都是通过服务器传递的（也有例外，例如在两个客户端传输文件时）采用这种结构，主要是为了简化客户端，将大多数工作放在服务器端进行，这样客户端的工作就比较简单，而且，当增加功能时，多数在服务器端进行。</p>
<ul>
<li>节点连接到服务器</li>
<li>服务器利用本地目录系统中的证书对其认证</li>
<li>节点指定目标地址，让服务器告知目标状态</li>
<li>服务器查找，连接并进行相互验证</li>
<li>节点之间进行交互</li>
</ul>
<h2 id="三、XMPP的优缺点">三、XMPP的优缺点</h2><h3 id="优点">优点</h3><ul>
<li>开放</li>
<li>标准</li>
<li>证实可用，谷歌证实了GTalk</li>
<li>分布式</li>
<li>安全</li>
<li>可扩展</li>
<li>弹性佳</li>
<li>多样性</li>
</ul>
<h3 id="缺点">缺点</h3><ul>
<li>数据负载过重XML</li>
<li>没有二进制传输<h2 id="四、XMPP通讯流程">四、XMPP通讯流程</h2></li>
</ul>
<ol>
<li>首先，由客户端连接到服务器，客户端通过IO流发送一段XML文件，在文件中包含了自身的用户名和密码；</li>
<li>服务器端接收到客户端的XML文件，从中获取用户名和密码进行验证，如果验证成功，服务器会发送一个XML文件给客户端表明已经登录成功；<ol>
<li>登录成功后，客户端可以通过发送一个获取好友名单的XML文件，服务器会将当前用户的好友以XML文件传到客户端；</li>
<li>客户端选择一个好友，向其发送消息（其实是向服务器发送，服务器收到后会转发给对应的好友），好友收到。</li>
</ol>
</li>
</ol>
<h2 id="五、功能实现">五、功能实现</h2><h3 id="1-导入XMPP框架">1.导入XMPP框架</h3><ul>
<li>下载XMPPFramework</li>
<li>导入依赖矿建</li>
<li>导入一下文件夹</li>
<li>导入XMPP扩展框架</li>
</ul>
<h3 id="2-登录&amp;注销">2.登录&amp;注销</h3><h4 id="2-1登录">2.1登录</h4><ul>
<li><p>实例化XMPPStream并设置代理，同时添加代理到工作队列      </p>
</li>
<li><p>使用JID连接至服务器，默认端口为5222，JID字符串中需要包含服务器的域名     </p>
</li>
<li><p>在完成连接的代理方法中验证用户密码，连接完成后XMPPStream的isConnect属性为YES     </p>
</li>
<li><p>在验证代理方法中判断用户是否登录成功        </p>
</li>
<li><p>上线或者下线成功后，向服务器发送Presence数据，以更新用户在服务器的状态</p>
</li>
</ul>
<h4 id="2-2注销">2.2注销</h4><ul>
<li>发送 离线 信息</li>
<li>断开连接</li>
</ul>
<h3 id="3-注册">3.注册</h3><ul>
<li><p>与登录一样，首先发送帐号建立连接</p>
</li>
<li><p>连接成功后，发送注册的密码</p>
</li>
<li><p>注册成功后，框架会通知代理</p>
</li>
</ul>
<h3 id="4-用户信息">4.用户信息</h3><h3 id="5-好友">5.好友</h3><h3 id="6-消息">6.消息</h3><h3 id="7-文件传送（图片，音频）">7.文件传送（图片，音频）</h3><h3 id="8-XAMPP和Openfire配置">8.XAMPP和Openfire配置</h3><ul>
<li>XAMPP（Apache+MySQL+PHP+PERL）是一个功能强大的建 XAMPP 软件站集成软件包。这个软件包原来的名字是 LAMPP，但是为了避免误解，最新的几个版本就改名为 XAMPP 了。它可以在Windows、Linux、Solaris、Mac OS X 等多种操作系统下安装使用，支持多语言：英文、简体中文、繁体中文、韩文、俄文、日文等。</li>
<li>许多人通过他们自己的经验认识到安装 Apache 服务器是件不容易的事儿。如果您想添加 MySQL、PHP 和 Perl，那就更难了。XAMPP 是一个易于安装且包含 MySQL、PHP 和 Perl 的 Apache 发行版。XAMPP 的确非常容易安装和使用：只需下载，解压缩，启动即可。</li>
<li>Openfire 您可以使用它轻易的构建高效率的即时通信服务器.Openfire安装和使用都非常简单，并利用Web进行管理。单台服务器可支持上万并发用户。由于是采用开放的XMPP协议，您可以使用各种支持XMPP协议的IM客户端软件登陆服务.</li>
<li>XAMPP需要把Manage Servers中三项全部开启</li>
<li>Openfire的Status需要保持开启,控制器默认用户名admin，密码admin，可以修改密码</li>
<li>openfire进入控制台需要配置数据库需要本机服务器名和数据库，数据库创建后需要Command+Shift+G 前往文件夹/usr/local  修改openfire的权限，然后复制此路径的文件/usr/local/openfire/resources/database/openfire_mysql.sql，把复制出的文件导入数据库，然后用户名默认为root</li>
<li>聊天的时候需要区分IP地址和域名</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-RunLoop" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/30/RunLoop/" class="article-date">
  	<time datetime="2016-03-30T01:41:30.000Z" itemprop="datePublished">2016-03-30</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="RunLoop">RunLoop</h1><p>一般来讲，一个线程一次只能执行一个任务，执行完成后线程就会退出。如果我们需要一个机制，让线程能随时处理事件但并不退出，实现这种机制的关键点在于：如何管理事件/消息，如何让线程在没有处理消息时休眠以避免资源占用、在有消息到来时立刻被唤醒。<br>OSX/iOS 系统中，提供了两个这样的对象：NSRunLoop 和 CFRunLoopRef。</p>
<ul>
<li><p>CFRunLoopRef 是在 CoreFoundation 框架内的，它提供了纯 C 函数的 API，所有这些 API 都是线程安全的。</p>
</li>
<li><p>NSRunLoop 是基于 CFRunLoopRef 的封装，提供了面向对象的 API，但是这些 API 不是线程安全的。</p>
</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-iOS应用程序启动流程" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/28/iOS应用程序启动流程/" class="article-date">
  	<time datetime="2016-03-28T02:32:38.000Z" itemprop="datePublished">2016-03-28</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="iOS应用程序运行流程">iOS应用程序运行流程</h1><h2 id="iOS应用程序运行流程图">iOS应用程序运行流程图</h2><p><img src="http://ac-1xcpPTqJ.clouddn.com/87e9b94a226cbd20.png" alt="iOS应用程序运行流程"></p>
<h2 id="iOS四大对象关系图">iOS四大对象关系图</h2><p><img src="http://ac-1xcpPTqJ.clouddn.com/faac1f0be28a4522.png" alt="iOS四大对象关系图"></p>
<h2 id="iOS中MVC">iOS中MVC</h2><p><img src="http://ac-1xcpPTqJ.clouddn.com/a8b7a3c1ceed4dfb.png" alt="iOSMVC"></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Socket(2)" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/23/Socket(2)/" class="article-date">
  	<time datetime="2016-03-23T06:17:01.000Z" itemprop="datePublished">2016-03-23</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Socket通信">Socket通信</h1><h2 id="什么是Socket">什么是Socket</h2><p>Socket 英文直译为“孔或插座”，也称为套接字。用于描述 IP 地址和端口号，是一种进程间的通信机制。你可以理解为 IP 地址确定了网内的唯一计算机，而端口号则指定了将消息发送给哪一个应用程序（大多应用程序启动时会主动绑定一个端口，如果不主动绑定，操作系统自动为其分配一个端口）。</p>
<h2 id="什么是端口">什么是端口</h2><p>一台主机一般运行了多个软件并同时提供一些服务。每种服务都会打开一个 Socket，并绑定到一个端口号上，不同端口对应于不同的应用程序。例如 http 使用 80 端口；ftp 使用 21 端口；smtp 使用 23 端口。</p>
<h2 id="Socket_的类型">Socket 的类型</h2><ul>
<li>Stream：一种流式 Socket，针对于面向连接的 TCP 服务应用，安全，但效率低。（本文重点）</li>
<li>Datagram：数据报式的 Socket，针对于无连接的 UDP 服务应用，不安全（丢失、顺序混乱，往往在接收端要分析完整性、重排、或要求重发），但效率高。</li>
</ul>
<h2 id="Socket_程序一般应用模式及运行流程">Socket 程序一般应用模式及运行流程</h2><ul>
<li><p>服务器端会启动一个 Socket，开始监听端口，监听客户端的连接信息，我们称之为 Watch Socket。</p>
</li>
<li><p>客户端 Socket 连接服务器端的监听 Socket，一旦成功连接，服务器端会立刻创建一个新的 Socket 负责与客户端进行通信，之后，客户端将不再与 Watch Socket 通信。</p>
</li>
<li><p>Watch Socket 继续监听可能会来自其他客户端的连接。</p>
</li>
</ul>
<p>上述过程就像是实现了一次三方会谈。服务器端的 Socket 至少会有 2 个。一个是 Watch Socket，每成功接收到一个客户端的连接，便在服务器端创建一个通信 Socket。客户端 Socket 指定要连接的服务器端地址和端口，创建一个 Socket 对象来初始化一个到服务器的 TCP 连接。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-NSFileManager" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/22/NSFileManager/" class="article-date">
  	<time datetime="2016-03-22T02:09:14.000Z" itemprop="datePublished">2016-03-22</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="NSFileManager及NSFileHandle">NSFileManager及NSFileHandle</h1><h2 id="创建文件及写入数据">创建文件及写入数据</h2><pre>
    文件管理器
    NSFileManager *fileManager = [NSFileManager defaultManager];

    Document路径
    NSArray *filePathArray = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);

    文件路径拼接
    NSString *filePath = [[filePathArray lastObject] stringByAppendingPathComponent:@"file.txt"];

    创建文件并写入数据
    [fileManager createFileAtPath:filePath contents:[@"Hello" dataUsingEncoding:NSUTF8StringEncoding] attributes:nil];
</pre>

<h2 id="向文件中更新数据">向文件中更新数据</h2><pre>
    文件操作器，向filePath对应路径文件更新数据
    NSFileHandle *fileHandle = [NSFileHandle fileHandleForUpdatingAtPath:filePath];

    找到文件末尾
    [fileHandle seekToEndOfFile];

    数据
    NSString *strFile = @"world";

    数据转换
    NSData *strData = [strFile dataUsingEncoding:NSUTF8StringEncoding];

    写入文件
    [fileHandle writeData:strData];

    关闭文件
    [fileHandle closeFile];
</pre>

<h2 id="从文件中读取数据">从文件中读取数据</h2><pre>
    获取数据长度
    NSUInteger length = [[fileHandle availableData] length];

    偏移量文件的一半
    [fileHandle seekToFileOffset:length/2.0];

    读出数据
    NSData * data = [fileHandle readDataToEndOfFile];

    关闭文件
    [fileHandle closeFile];

    数据转换为字符串
    NSString * string = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding];

    打印读出的数据
    NSLog(@"====%@",string);
</pre>

<h2 id="文件复制-从源文件拷贝到目标文件">文件复制-从源文件拷贝到目标文件</h2><pre>
源文件路径
NSString * sourcePath = [[filePathArray lastObject] stringByAppendingPathComponent:@"sourceFile.txt"]; 

创建源文件并写入数据
[manager createFileAtPath:sourcePath contents:[@"Hello" dataUsingEncoding:NSUTF8StringEncoding] attributes:nil];

目标文件路径 
NSString * destPath = [[filePathArray lastObject] stringByAppendingPathComponent:@"destFile.txt"];

创建目标文件并写入数据
BOOL success = [manager createFileAtPath:destPath contents:[@"abcdef" dataUsingEncoding:NSUTF8StringEncoding] attributes:nil];

判读目标文件是否创建成功
if (!success) {
        return;
    }

源文件操作器    
NSFileHandle *srcFile = [NSFileHandle fileHandleForReadingAtPath:sourcePath];

判断源文件操作器是否创建成功
if (!srcFile) {
        return;
    }

目标文件操作器
NSFileHandle *destFile = [NSFileHandle fileHandleForWritingAtPath:destPath];

判断目标文件操作器是否创建成功
if (!destFile) {
        return;
    }

将输出文件的长度设为0,(也就是将原来的文件清空)
[destFile truncateFileAtOffset:0];

读取源文件数据
NSData *buffer = [srcFile readDataToEndOfFile];

将数据写入目标文件
[destFile writeData:buffer];

关闭源文件及目标文件
[srcFile closeFile];
[destFile closeFile];
</pre>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-iOS强制横屏" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/21/iOS强制横屏/" class="article-date">
  	<time datetime="2016-03-21T06:32:05.000Z" itemprop="datePublished">2016-03-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="iOS强制横屏">iOS强制横屏</h1><pre>- (BOOL)shouldAutorotate
{
    //是否支持转屏
    return YES;
}
</pre>

<pre>- (UIInterfaceOrientationMask)supportedInterfaceOrientations
{
    //支持哪些转屏方向
    return UIInterfaceOrientationMaskLandscape;
}
</pre>
<pre>- (UIInterfaceOrientation)preferredInterfaceOrientationForPresentation
{
   //首选页面的方向
    return UIInterfaceOrientationLandscapeLeft;
}
</pre>
<pre>
- (BOOL)prefersStatusBarHidden
{
   //是否隐藏状态栏
    return NO;
}
</pre>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Openfire启动失败解决办法" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/18/Openfire启动失败解决办法/" class="article-date">
  	<time datetime="2016-03-18T09:18:10.000Z" itemprop="datePublished">2016-03-18</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Openfire启动失败解决办法">Openfire启动失败解决办法</h1><p>Openfire无论你重新安装还是重启都无法启动的情况下,解决办法如下：<br>打开终端执行以下指令</p>
<ol>
<li><p>获取权限<br>sudo chmod -R 777 /usr/local/openfire/bin</p>
</li>
<li><p>sudo su</p>
</li>
<li>cd /usr/local/openfire/bin</li>
<li>export JAVA_HOME=<code>/usr/libexec/java_home</code> (记住这里不是单引号而是英文下数字1左边的按键)</li>
<li>echo $JAVA_HOME<br>终端输出结果：<br>/Library/Java/JavaVirtualMachines/jdk1.8.0_25.jdk/Contents/Home</li>
<li>cd /usr/local/openfire/bin</li>
<li>./openfire.sh<br>终端输出结果：<br>Admin console listening at <a href="http://niufangludemacbook-pro.local:9090" target="_blank" rel="external">http://niufangludemacbook-pro.local:9090</a></li>
</ol>
<p>通过以上命令还有结果的输出证明Openfire已经可以启动成功了</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-iOS支付" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/14/iOS支付/" class="article-date">
  	<time datetime="2016-03-14T08:27:07.000Z" itemprop="datePublished">2016-03-14</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="iOS开发支付功能">iOS开发支付功能</h1><ul>
<li>微信支付<a href="https://pay.weixin.qq.com/wiki/doc/api/index.html" target="_blank" rel="external">微信网址</a></li>
<li>支付宝支付<a href="https://b.alipay.com/order/productDetail.htm?productId=2015110218010538&amp;tabId=1#ps-tabinfo-hash%20http://doc.open.alipay.com/doc2/detail?treeId=59&amp;articleId=103563&amp;docType=1" target="_blank" rel="external">支付宝支付</a><ul>
<li>支付宝移动支付<a href="https://doc.open.alipay.com/doc2/detail?treeId=59&amp;articleId=103563&amp;docType=1" target="_blank" rel="external">移动支付</a></li>
<li>银联支付<a href="https://open.unionpay.com/ajweb/index" target="_blank" rel="external">银联支付</a></li>
<li>百度钱包支付<a href="http://apistore.baidu.com/astore/serviceinfo/1479.html" target="_blank" rel="external">百度钱包</a></li>
<li>QQ钱包支付<a href="http://qpay.qq.com" target="_blank" rel="external">QQ钱包</a></li>
<li>ApplePay支付<a href="https://developer.apple.com/apple-pay/" target="_blank" rel="external">ApplePay</a></li>
</ul>
</li>
</ul>
<p>微信支付详解博客<a href="http://www.cnblogs.com/goodboy-heyang/p/5255818.html" target="_blank" rel="external">微信支付详解</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-ApplePay" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/14/ApplePay/" class="article-date">
  	<time datetime="2016-03-14T07:54:54.000Z" itemprop="datePublished">2016-03-14</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="ApplePay">ApplePay</h1><h2 id="准备阶段">准备阶段</h2><ol>
<li>硬件要求：iPhone6及更新的设备，还有iPad air2和iPad mini3之后的平板，以及apple watch。具体型号（截止2016年2月）：iPhone 6，iPhone 6 Plus，iPhone 6s， iPhone 6s Plus；iPad Air 2，iPad mini 3，iPad mini 4，iPad Pro；还有Apple Watch。</li>
<li>系统要求：iPhone或iPad至少要升到iOS 9.2版，手表至少watch OS 2.1。</li>
<li>配置支付环境<ul>
<li>进入苹果开发者中心，注册App ID。App ID必须是explicit类型，否则无法使用ApplePay服务。</li>
<li>勾选Apple Pay并点击continue。</li>
<li>点击submit提交。</li>
<li>在App IDs中找到刚刚注册成功的App ID，点击edit，对Apple Pay进行配置。</li>
<li>创建MerchantID。</li>
<li>配置Apple Pay服务，勾选Merchant ID。</li>
<li>App ID的apple pay选项变成enable表示配置成功。</li>
<li>创建Xcode项目，填入刚注册的BundleID。</li>
<li>在项目的target-&gt;Capabilities中，打开Apple Pay，并勾选Merchant ID。</li>
</ul>
</li>
</ol>
<h2 id="代码实现">代码实现</h2><ol>
<li>判断支付环境<ul>
<li>导入Passkit框架</li>
<li>判断当前设备是否支持Apple Pay以及wallet中是否有符合所支持网络的银行卡</li>
<li>若wallet中没有绑定所支持网络的银行卡，则点击按钮跳转到wallet中去绑定银行卡</li>
<li>若该设备支持Apple Pay并且有绑定所支持网络的银行卡则发起支付请求</li>
<li>支付请求配置包括国家代码、货币代码、商家ID、商家的处理方式、商家支持的网络、订单的详情，这几个要素缺一不可</li>
<li>监听用户授权状态</li>
</ul>
</li>
<li>流程可看下图<img src="http://ac-1xcpPTqJ.clouddn.com/b9437fe6f80988bf.png" alt="ApplePay"></li>
<li>代码详见附件<a href="http://ac-1xcpPTqJ.clouddn.com/2546e05c7816bba8.zip" target="_blank" rel="external">ApplePay</a></li>
</ol>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2016 ICQ
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>